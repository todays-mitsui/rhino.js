var M=Object.defineProperty;var E=(n,t,e)=>t in n?M(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var l=(n,t,e)=>(E(n,typeof t!="symbol"?t+"":t,e),e);import{m as i}from"./vendor.5e96b68d.js";const k=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}};k();const v=class{constructor(){l(this,"_enable",!0);l(this,"callbacks",[]);l(this,"ax");l(this,"ay");l(this,"az");l(this,"gx");l(this,"gy");l(this,"gz");this.ax=0,this.ay=0,this.az=0,this.gx=0,this.gy=0,this.gz=0}async requestPermission(){if(DeviceMotionEvent==null)return this._enable=!1;if(!("requestPermission"in DeviceMotionEvent))return this._enable=!0;const t=await DeviceMotionEvent.requestPermission();return this._enable=t=="granted"}hander(t){const e=v.K;let{x:r,y:o,z:s}=t.acceleration,{x:a,y:d,z:c}=t.accelerationIncludingGravity;r==null&&o==null&&s==null&&(this._enable=!1,window.removeEventListener("devicemotion",this.hander)),this.ax=(1-e)*this.ax+e*r,this.ay=(1-e)*this.ay+e*o,this.az=(1-e)*this.az+e*s,this.gx=(1-e)*this.gx+e*a,this.gy=(1-e)*this.gy+e*d,this.gz=(1-e)*this.gz+e*c;for(let g of this.callbacks)g(t)}onDeviceMotion(t){this.callbacks.push(t)}get enable(){return this._enable}get acceleration(){if(!this._enable)return{x:0,y:0,z:0,norm:0};const t=this.ax*this.ax+this.ay*this.ay+this.az*this.az;return{x:this.ax,y:this.ay,z:this.az,norm:t}}get gravity(){return this._enable?{x:this.gx,y:this.gy,z:this.gz}:{x:0,y:0,z:0}}};let p=v;l(p,"K",.01);function L(n,t){const e=2,r=20,o=i.exports.Bodies.rectangle(n/2,-(r/2+e),n+2*e,r,{isStatic:!0}),s=i.exports.Bodies.rectangle(-(r/2+e),t/2,r,t+2*e,{isStatic:!0}),a=i.exports.Bodies.rectangle(n/2,t-r,n+2*e,r*2,{isStatic:!0,render:{fillStyle:"#000000"}}),d=i.exports.Bodies.rectangle(n+r/2+e,t/2,r,t+2*e,{isStatic:!0});return{top:o,left:s,bottom:a,right:d}}function q(n,t){const e=n.clientWidth,r=n.clientHeight,o=i.exports.Engine.create(),s=L(e,r);i.exports.World.add(o.world,[...Object.values(s),t]);const a=i.exports.Render.create({element:n,engine:o,options:{width:e,height:r,wireframes:!1,background:"transparent"}});i.exports.Render.run(a);const d=i.exports.Runner.create();return i.exports.Runner.run(d,o),{engine:o,render:a,runner:d,ground:s.bottom}}function _(){const n=Math.random()*10-5,t=-Math.random()*10-5,e=D()*P(100,.2)*.01;return{x:n,y:t,angular:e}}function D(){return Math.random()>.5?1:-1}function P(n,t){let e=0;for(let r=0;r<n;r++)Math.random()<t&&e++;return e}function B(n){const t=7-n,e=Array.from(Array(6),(r,o)=>o+1).filter(r=>![n,t].includes(r));return A(e)}function A(n){const t=Math.floor(Math.random()*n.length);return n[t]}function f(n){const t=["","\u2680","\u2681","\u2682","\u2683","\u2684","\u2685"],e=document.createElement("canvas");e.width=60,e.height=60;const r=e.getContext("2d");r.font="74px sans-serif",r.fillStyle="rgba(0, 0, 0)",r.textBaseline="middle",r.textAlign="center",r.fillText(t[n],30,30);const o=e.toDataURL();return e.remove(),o}function O(n,t,e=30){const r=i.exports.Bodies.rectangle(n,t,e,e,{angle:1,restitution:.8,friction:.05,render:{sprite:{texture:f(6),xScale:.5,yScale:.5}}});return x(r),r}function x(n,t,e,r){if(t==null||e==null||r==null){const{x:o,y:s,angular:a}=_();t=t||o,e=e||s,r=r||a}i.exports.Body.setVelocity(n,{x:t,y:e}),i.exports.Body.setAngularVelocity(n,r)}function R(n,t){let e=0,r=1;return()=>{const o=Math.floor(n.angle*2/Math.PI+.5)%4;if(e==o)return;const s=B(r);n.render.sprite.texture=t.get(s),e=o,r=s}}function K(n,t=500){let e=Date.now()-t;return(...r)=>{e+t<Date.now()&&(e=Date.now(),n(...r))}}const m=new p,w=document.querySelector(".start");w.addEventListener("click",async()=>{const n=await m.requestPermission();w.remove(),n&&window.addEventListener("devicemotion",t=>{m.hander(t)}),V(m)});function V(n){const t=document.querySelector("#app"),e=t.clientWidth,r=t.clientHeight,o=O(e/2,r/4),{engine:s,render:a,runner:d,ground:c}=q(t,o);t.addEventListener("click",()=>{x(o)});const g=new Map([[1,f(1)],[2,f(2)],[3,f(3)],[4,f(4)],[5,f(5)],[6,f(6)]]);i.exports.Events.on(s,"beforeUpdate",R(o,g)),document.querySelector("#fill").addEventListener("click",()=>{c.render.fillStyle="#000000",c.render.lineWidth=0,c.render.strokeStyle="transparent"}),document.querySelector("#line").addEventListener("click",()=>{c.render.fillStyle="transparent",c.render.lineWidth=.5,c.render.strokeStyle="#000000"}),document.querySelector("#transparent").addEventListener("click",()=>{c.render.fillStyle="transparent",c.render.lineWidth=0,c.render.strokeStyle="transparent"});const z=K((h,u)=>{x(o,h,u)},2e3);n.onDeviceMotion(()=>{if(n.enable){const{x:h,y:u,norm:y}=n.acceleration;y>1&&(console.log({x:h,y:u,norm:y}),z(5*h,5*u))}}),i.exports.Events.on(s,"beforeUpdate",h=>{if(n.enable&&h.timestamp%1e3<50){const{x:u,y}=n.gravity,b=u*u+y*y;if(b>=6){const S=Math.sqrt(b);s.gravity.x=u/S,s.gravity.y=-y/S}}})}
