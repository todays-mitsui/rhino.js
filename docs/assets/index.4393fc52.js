var _=Object.defineProperty,E=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var h=(n,e,t)=>e in n?_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,g=(n,e)=>{for(var t in e||(e={}))k.call(e,t)&&h(n,t,e[t]);if(v)for(var t of v(e))D.call(e,t)&&h(n,t,e[t]);return n},p=(n,e)=>E(n,L(e));var a=(n,e,t)=>(h(n,typeof e!="symbol"?e+"":e,t),t);import{m as s}from"./vendor.5e96b68d.js";const S=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};S();const b=class{constructor(){a(this,"_enable",!0);a(this,"callbacks",[]);a(this,"ax");a(this,"ay");a(this,"az");a(this,"gx");a(this,"gy");a(this,"gz");this.ax=0,this.ay=0,this.az=0,this.gx=0,this.gy=0,this.gz=0}async requestPermission(){if(DeviceMotionEvent==null)return this._enable=!1;if(!("requestPermission"in DeviceMotionEvent))return this._enable=!0;const e=await DeviceMotionEvent.requestPermission();return this._enable=e=="granted"}hander(e){const t=b.K;let{x:o,y:r,z:i}=e.acceleration,{x:c,y:l,z:d}=e.accelerationIncludingGravity;o==null&&r==null&&i==null&&(this._enable=!1,window.removeEventListener("devicemotion",this.hander)),this.ax=(1-t)*this.ax+t*o,this.ay=(1-t)*this.ay+t*r,this.az=(1-t)*this.az+t*i,this.gx=(1-t)*this.gx+t*c,this.gy=(1-t)*this.gy+t*l,this.gz=(1-t)*this.gz+t*d;for(let u of this.callbacks)u(e)}onDeviceMotion(e){this.callbacks.push(e)}get enable(){return this._enable}get acceleration(){if(!this._enable)return{x:0,y:0,z:0,norm:0};const e=this.ax*this.ax+this.ay*this.ay+this.az*this.az;return{x:this.ax,y:this.ay,z:this.az,norm:e}}get gravity(){return this._enable?{x:this.gx,y:this.gy,z:this.gz}:{x:0,y:0,z:0}}};let m=b;a(m,"K",.01);function q(n,e){const t=12,o=12,r=20,i={isStatic:!0,render:{fillStyle:"#ffffff"}},c=s.exports.Bodies.rectangle(n/2,o-r/2,n,r,i),l=s.exports.Bodies.rectangle(t-r/2,e/2,r,e,p(g({},i),{restitution:.9})),d=s.exports.Bodies.rectangle(n/2,e-o+r/2,n,r,i),u=s.exports.Bodies.rectangle(n-t+r/2,e/2,r,e,p(g({},i),{restitution:.9}));return{top:c,left:l,bottom:d,right:u}}function B(n,e){const t=n.clientWidth,o=n.clientHeight,r=s.exports.Engine.create(),i=q(t,o);s.exports.World.add(r.world,[...Object.values(i),e]);const c=s.exports.Render.create({element:n,engine:r,options:{width:t,height:o,wireframes:!1,background:"transparent"}});s.exports.Render.run(c);const l=s.exports.Runner.create();return s.exports.Runner.run(l,r),{engine:r,render:c,runner:l,ground:i.bottom}}function O(){const n=w()*z(100,.3)*.08,e=-Math.random()*12-7,t=w()*z(100,.22)*.012;return{x:n,y:e,angular:t}}function w(){return Math.random()>.5?1:-1}function z(n,e){let t=0;for(let o=0;o<n;o++)Math.random()<e&&t++;return t}function A(n){const e=7-n,t=Array.from(Array(6),(o,r)=>r+1).filter(o=>![n,e].includes(o));return K(t)}function K(n){const e=Math.floor(Math.random()*n.length);return n[e]}function R(n,e,t=30){const o=s.exports.Bodies.rectangle(n,e,t,t,{angle:1,restitution:.8,friction:.05,render:{sprite:{texture:"/img/dice-6.png",xScale:.206897,yScale:.206897}}});return y(o,null,4),o}function y(n,e=null,t=null,o=null){if(e==null||t==null||o==null){const{x:r,y:i,angular:c}=O();e=e||r,t=t||i,o=o||c}s.exports.Body.setVelocity(n,{x:e,y:t}),s.exports.Body.setAngularVelocity(n,o)}function V(n,e){let t=0,o=1;return()=>{const r=Math.floor(n.angle*2/Math.PI+.5)%4;if(t==r)return;const i=A(o);n.render.sprite.texture=e.get(i),t=r,o=i}}function I(n,e=500){let t=Date.now()-e;return(...o)=>{t+e<Date.now()&&(t=Date.now(),n(...o))}}const x=new m,M=document.querySelector(".start");M.addEventListener("click",async()=>{const n=await x.requestPermission();M.remove(),n&&window.addEventListener("devicemotion",e=>{x.hander(e)}),N(x)});function N(n){const e=document.querySelector("#app"),t=e.clientWidth,o=e.clientHeight,r=R(t/2,o/6),{engine:i,render:c,runner:l,ground:d}=B(e,r);e.addEventListener("click",()=>{y(r)});const u=new Map([[1,"/img/dice-1.png"],[2,"/img/dice-2.png"],[3,"/img/dice-3.png"],[4,"/img/dice-4.png"],[5,"/img/dice-5.png"],[6,"/img/dice-6.png"]]);s.exports.Events.on(i,"beforeUpdate",V(r,u));const P=I(f=>{y(r,null,null,f)},1200);n.onDeviceMotion(()=>{if(n.enable){const{norm:f}=n.acceleration;f>1&&P(f*.15)}})}
